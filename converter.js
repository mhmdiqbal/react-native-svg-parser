Object.defineProperty(exports,"__esModule",{value:true});exports.addNonCssAttributes=exports.findApplicableCssProps=exports.getCssRulesForAttr=exports.extractViewbox=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _jsxFileName='src/converter.js';var _react=require('react');var _react2=_interopRequireDefault(_react);var _camelcase=require('camelcase');var _camelcase2=_interopRequireDefault(_camelcase);var _reactNativeSvg=require('react-native-svg');var _reactNativeSvg2=_interopRequireDefault(_reactNativeSvg);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}else{return Array.from(arr);}}var mapping={'svg':_reactNativeSvg2.default,'circle':_reactNativeSvg.Circle,'ellipse':_reactNativeSvg.Ellipse,'g':_reactNativeSvg.G,'line':_reactNativeSvg.Line,'path':_reactNativeSvg.Path,'rect':_reactNativeSvg.Rect,'symbol':_reactNativeSvg.Symbol,'text':_reactNativeSvg.Text,'polygon':_reactNativeSvg.Polygon,'polyline':_reactNativeSvg.Polyline,'linearGradient':_reactNativeSvg.LinearGradient,'radialGradient':_reactNativeSvg.RadialGradient,'use':_reactNativeSvg.Use,'defs':_reactNativeSvg.Defs,'stop':_reactNativeSvg.Stop};function extractViewbox(markup){var viewBox=markup.attributes?Object.values(markup.attributes).filter(function(attr){return attr.name==='viewBox';})[0]:false;var vbSplits=viewBox?viewBox.value.split(' '):false;if(!vbSplits){return{};}return{width:''+vbSplits[2],height:''+vbSplits[3],viewBox:viewBox.value};}function getCssRulesForAttr(attr,cssRules){var rules=[];if(attr.name==='id'){var idname='#'+attr.value;rules=cssRules.filter(function(rule){if(rule.selectors.indexOf(idname)>-1){return true;}else{return false;}});}else if(attr.name==='class'){var className='.'+attr.value;rules=cssRules.filter(function(rule){if(rule.selectors.indexOf(className)>-1){return true;}else{return false;}});}return rules;}function addNonCssAttributes(markup,cssPropsResult){var attrs=[];Object.values(markup.attributes).forEach(function(attr){if(!attr||!attr.name){return;}var propertyName=(0,_camelcase2.default)(attr.name);if(propertyName==='class'||propertyName==='id'){return;}if(cssPropsResult.cssProps.indexOf(propertyName)>-1){return;}attrs.push({name:propertyName,value:''+attr.value});});return attrs;}function findApplicableCssProps(markup,config){var cssProps=[];var attrs=[];Object.values(markup.attributes).forEach(function(attr){var rules=getCssRulesForAttr(attr,config.cssRules);if(rules.length===0){return;}rules.forEach(function(rule){rule.declarations.forEach(function(declaration){var propertyName=(0,_camelcase2.default)(declaration.property);attrs.push({name:propertyName,value:''+declaration.value});cssProps.push(propertyName);});});});return{cssProps:cssProps,attrs:attrs};}function findId(markup){var id=Object.values(markup.attributes).find(function(attr){return attr.name==='id';});return id&&id.value;}function traverse(markup,config){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;if(!markup||!markup.nodeName||!markup.tagName){return null;}var tagName=markup.nodeName;var idName=findId(markup);if(idName&&config.omitById&&config.omitById.includes(idName)){return null;}var attrs=[];if(tagName==='svg'){var viewBox=extractViewbox(markup);attrs.push({name:'width',value:config.width||viewBox.width});attrs.push({name:'height',value:config.height||viewBox.height});attrs.push({name:'viewBox',value:config.viewBox||viewBox.viewBox||'0 0 50 50'});}else{var cssPropsResult=findApplicableCssProps(markup,config);var additionalProps=addNonCssAttributes(markup,cssPropsResult);attrs=[].concat(_toConsumableArray(attrs),_toConsumableArray(cssPropsResult.attrs),_toConsumableArray(additionalProps));}var Elem=mapping[tagName.toLowerCase()];if(!Elem){return null;}var children=Elem===_reactNativeSvg.Text&&markup.childNodes.length===1?markup.childNodes[0].data:markup.childNodes.length?Object.values(markup.childNodes).map(function(child){return traverse(child,config,++i);}).filter(function(node){return!!node;}):[];var elemAttributes={};attrs.forEach(function(attr){elemAttributes[attr.name]=attr.value;});var k=i+Math.random();return _react2.default.createElement(Elem,_extends({},elemAttributes,{key:k,__source:{fileName:_jsxFileName,lineNumber:194}}),children);}exports.extractViewbox=extractViewbox;exports.getCssRulesForAttr=getCssRulesForAttr;exports.findApplicableCssProps=findApplicableCssProps;exports.addNonCssAttributes=addNonCssAttributes;exports.default=function(dom,cssAst,config){config=_extends({},config,{cssRules:cssAst&&cssAst.stylesheet&&cssAst.stylesheet.rules||[]});return traverse(dom.documentElement,config);};
//# sourceMappingURL=converter.js.map